<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸŒ Student Fun Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f6f9ff;
      --panel: #ffffff;
      --panel-border: #e3e7ff;
      --text: #333;
      --muted: #666;
      --accent: #6a5acd;
      --accent-2: #ff7aa8;
      --accent-3: #ffa94d;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: Poppins, sans-serif;
      color: var(--text);
      background: var(--bg);
      display: grid;
      grid-template-columns: 300px 1fr;
      min-height: 100vh;
    }

    .sidebar {
      background: var(--panel);
      border-right: 2px solid var(--panel-border);
      padding: 18px 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .brand {
      font-weight: 800;
      font-size: 18px;
      color: var(--accent);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card {
      background: #f0f4ff;
      border-radius: 10px;
      padding: 10px 12px;
      text-align: center;
    }
    .card h4 { margin: 0; font-size: 12px; color: var(--muted); }
    .card .big { font-size: 20px; font-weight: 700; color: var(--accent-2); }

    .search {
      background: #f3f6ff;
      border-radius: 10px;
      padding: 8px 10px;
      display: flex;
      gap: 6px;
      align-items: center;
    }
    .search input {
      border: none;
      background: transparent;
      outline: none;
      font-size: 14px;
      flex: 1;
      color: var(--text);
    }

    .list {
      overflow: auto;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .student {
      background: #fff;
      border: 2px solid var(--panel-border);
      border-radius: 12px;
      padding: 8px 10px;
      display: grid;
      grid-template-columns: 36px 1fr auto;
      align-items: center;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .student:hover { transform: scale(1.03); background: #fdf7ff; }
    .emoji { font-size: 22px; }
    .name { font-weight: 600; }
    .place { font-size: 12px; color: var(--muted); }

    #map { height: 100vh; width: 100%; }

    .emoji-marker {
      background: #fff;
      border-radius: 50%;
      border: 2px solid var(--accent);
      width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center;
      font-size: 20px;
      animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    .leaflet-popup-content-wrapper {
      background: #fff;
      color: var(--text);
      border-radius: 10px;
      border: 2px solid var(--accent-3);
    }

    .popup-card { font-family: Poppins; text-align: center; }
    .popup-title { font-weight: 700; color: var(--accent-2); font-size: 16px; }
    .popup-sub { color: var(--muted); font-size: 12px; }

    @media(max-width: 800px){
      body { grid-template-columns: 1fr; }
      .sidebar { position: fixed; bottom: 0; left: 0; right: 0; height: 45%; overflow: auto; border-right: none; border-top: 2px solid var(--panel-border); }
      #map { height: 55vh; }
    }
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="brand">ğŸˆ Student Fun Map</div>
    <div class="card"><h4>Total Students</h4><div class="big" id="countTotal">0</div></div>
    <div class="card"><h4>Countries</h4><div class="big" id="countCountries">0</div></div>
    <div class="search"><input id="searchInput" placeholder="Search..."/></div>
    <div class="list" id="studentList"></div>
  </aside>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script>
    const students = [
      { name: "Ana Popescu", emoji: "ğŸ¦„", city: "BacÄƒu", country: "Romania ğŸ‡·ğŸ‡´", lat: 46.571, lng: 26.925 },
      { name: "Luca Ionescu", emoji: "âš½", city: "BucureÈ™ti", country: "Romania ğŸ‡·ğŸ‡´", lat: 44.4268, lng: 26.1025 },
      { name: "Mara D.", emoji: "ğŸ¨", city: "Cluj-Napoca", country: "Romania ğŸ‡·ğŸ‡´", lat: 46.7712, lng: 23.6236 },
      { name: "Elif", emoji: "ğŸ“š", city: "Istanbul", country: "TÃ¼rkiye ğŸ‡¹ğŸ‡·", lat: 41.0082, lng: 28.9784 },
      { name: "Sophia", emoji: "ğŸŒ¸", city: "Rome", country: "Italy ğŸ‡®ğŸ‡¹", lat: 41.9028, lng: 12.4964 },
    ];

    const map = L.map('map');
    L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const bounds = [];
    const countries = new Set();

    function emojiIcon(emoji) {
      return L.divIcon({ html: `<div class='emoji-marker'>${emoji}</div>`, iconSize: [36,36], className: '' });
    }

    const markers = new Map();
    students.forEach(s => {
      countries.add(s.country);
      const marker = L.marker([s.lat, s.lng], { icon: emojiIcon(s.emoji) }).addTo(map)
        .bindPopup(`<div class='popup-card'><div class='popup-title'>${s.emoji} ${s.name}</div><div class='popup-sub'>${s.city}, ${s.country}</div></div>`);
      markers.set(s.name, marker);
      bounds.push([s.lat, s.lng]);
    });

    if (bounds.length) map.fitBounds(bounds, { padding: [40,40] });

    document.getElementById('countTotal').textContent = students.length;
    document.getElementById('countCountries').textContent = countries.size;

    const list = document.getElementById('studentList');
    function render(listData){
      list.innerHTML = '';
      listData.forEach(s => {
        const el = document.createElement('div');
        el.className = 'student';
        el.innerHTML = `<div class='emoji'>${s.emoji}</div><div><div class='name'>${s.name}</div><div class='place'>${s.city}, ${s.country}</div></div>`;
        el.onclick = () => {
          map.flyTo([s.lat, s.lng], 8, { duration: 1 });
          markers.get(s.name).openPopup();
        };
        list.appendChild(el);
      });
    }
    render(students);

    document.getElementById('searchInput').addEventListener('input', e => {
      const q = e.target.value.toLowerCase();
      render(students.filter(s => s.name.toLowerCase().includes(q) || s.city.toLowerCase().includes(q)));
    });
  </script>
</body>
</html>
